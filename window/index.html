<!DOCTYPE html>
<html lang="ru" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Устройство для автоматического управления форточкой | Заметочки</title>
<meta name="keywords" content="" />
<meta name="description" content="чтобы никто в комнате не душнил">
<meta name="author" content="">
<link rel="canonical" href="https://ichekanov.ru/window/" />
<link crossorigin="anonymous" href="../assets/css/stylesheet.min.9908981cfb55df6e11dd5af1330cc1083bd4c958c5887a3353736b4e2682bd41.css" integrity="sha256-mQiYHPtV324R3VrxMwzBCDvUyVjFiHozU3NrTiaCvUE=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="../assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js" integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://ichekanov.ru/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://ichekanov.ru/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://ichekanov.ru/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://ichekanov.ru/apple-touch-icon.png">
<link rel="mask-icon" href="https://ichekanov.ru/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.95.0" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script type="text/javascript">
    (function(m, e, t, r, i, k, a) {
        m[i] = m[i] || function() {
            (m[i].a = m[i].a || []).push(arguments)
        };
        m[i].l = 1 * new Date();
        k = e.createElement(t), a = e.getElementsByTagName(t)[0], k.async = 1, k.src = r, a.parentNode.insertBefore(k, a)
    })
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(89037392, "init", {
        clickmap: true,
        trackLinks: true,
        accurateTrackBounce: true
    });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/89037392" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<meta property="og:title" content="Устройство для автоматического управления форточкой" />
<meta property="og:description" content="чтобы никто в комнате не душнил" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ichekanov.ru/window/" /><meta property="article:section" content="" />



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Устройство для автоматического управления форточкой"/>
<meta name="twitter:description" content="чтобы никто в комнате не душнил"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Устройство для автоматического управления форточкой",
      "item": "https://ichekanov.ru/window/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Устройство для автоматического управления форточкой",
  "name": "Устройство для автоматического управления форточкой",
  "description": "чтобы никто в комнате не душнил",
  "keywords": [
    
  ],
  "articleBody": "— Закрой окно, а не то твой брат заболеет. Лечить его будешь сам! — сказала в очередной раз мама.\nА что делать? Пришлось закрыть.\nКаждый день происходило одно и то же: я открывал окно из-за жары и духоты, в комнату врывался декабрьский двадцатиградусный мороз, приходила мама и объявляла побочные эффекты этого самого мороза. Напоминание о том, что в комнате сидят два человека, которым позарез нужен кислород не действовали. Пришлось включать голову. И знаете, помогло! Тогда я ничего не знал об индустрии автоматического проветривания (и даже не предполагал о её существовании), а потому решил действовать по наитию.\nЕсли формально, то техническое задание было придумано такое. Сделать магическую коробочку для поддержания оптимальной температуры в комнате во время отопительного сезона. На основании температуры в комнате должно выбираться наиболее оптимальное положение форточки, при котором температура не упадёт ниже комфортного уровня, но при этом сохранится наибольший приток свежего воздуха.\nС чего же начать? Пожалуй, с механики. Самый простой способ что-то двигать с помощью электричества — это электромотор, вращающий свой вал. После недолгих поисков был куплен простейший редукторный шаговый моторчик, который ставят в очень бюджетные принтеры. Обвязка в виде термометра и ардуины нашлась в закромах.\nРабота закипела: за два дня был собран первый прототип на макетной плате и написана первая версия прошивки. Но это и правда было увлекательно, а потому просто. Только вот как превратить крутящий момент мотора в поступательное движение? Себе-то я этот вопрос не задавал, ведь под парами всегда стоит 3D принтер. При помощи нескольких пластиковых деталей, болта с гайкой и капли суперклея мотор научился передвигать каретку в плоскости, перпендикулярной валу.\n   Тут много подробностей о костылях, которые пришлось применить Ну что, вперёд-назад каретка ездит, прошивка худо-бедно мотор крутит. Запускаем? Щаз!\nПроблема первая: тяга мотора примерно нулевая. Ни одна библиотека не помогла. А ещё и драйвер я достал не удобный, которому только частоту шагов подавай, а дедовский, который всего лишь сигнал с логического на силовой уровень меняет. Пришлось руками прописывать все такты мотора, анализируя принцип работы по гифке из интернета. Зато после этого момент вращения стал очень даже приличным. Всю зиму алгоритм шага не менялся, заеданий практически не было.\nПроблема вторая: клинит! Я радостно закрепил мотор на оконной раме, установил на створку ответную часть и осознал, что только в одном положении гайка нормально ходит по винту: при полностью закрытом окне. Времени заказывать гибкие муфты не было, поэтому был предпринят отчаянный шаг: мотор поселился на крючке-ограничителе. А что? К раме закреплён крепко, люфта как раз хватает чтобы окно могло приоткрываться. Смекало4ка!\nПроблема вторая с половиной: снова клинит! Теперь люфт оказался уже излишним. В положении закрытого окна мотор сильно менял своё положение и после этого уже не мог открыть окно. Пришлось приобрести длинную пружину, которая тянула всю систему вверх и удерживала мотор в оптимальном положении. Некрасиво, но сработало.\n   Дальше нужно было решить вопросы чисто эстетического плана: сделать корпус для электроники, собрать провода в жгут, отладить прошивку. Со временем прошивка научилась фиксировать окно в нескольких промежуточных положениях, красиво мигать светодиодом и даже автоматически вынимать винт из гайки, позволяя кожаному мешку самостоятельно открывать окно.\nИ вот результат работы: слева на фотографии самое начало проекта, а справа — состояние устройства через четыре месяца. И видео в качестве дополнения: тык.\n      Но чего-то всё равно не хватало. Не хватало компактности, эстетичности и стабильности работы.\nНа дворе осень 2022 года и я работаю над второй версией устройства. Она хоть и дороже, но куда компактнее и умнее предыдущей. Термометр работает по WiFi, мотор управляется хорошим драйвером, в качестве вала используется специальный винт. To be continued, как говорится…\n",
  "wordCount" : "573",
  "inLanguage": "ru",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://ichekanov.ru/window/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Заметочки",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ichekanov.ru/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ichekanov.ru/" accesskey="h" title="Заметочки (Alt + H)">Заметочки</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Устройство для автоматического управления форточкой
    </h1>
    <div class="post-description">
      чтобы никто в комнате не душнил
    </div>
    <div class="post-meta">

</div>
  </header> 
  <div class="post-content"><p>&mdash; Закрой окно, а не то твой брат заболеет. Лечить его будешь сам! &mdash; сказала в очередной раз мама.<br>
А что делать? Пришлось закрыть.</p>
<p>Каждый день происходило одно и то же: я открывал окно из-за жары и духоты, в комнату врывался декабрьский двадцатиградусный мороз, приходила мама и объявляла побочные эффекты этого самого мороза. Напоминание о том, что в комнате сидят два человека, которым позарез нужен кислород не действовали. Пришлось включать голову. И знаете, помогло! Тогда я ничего не знал об индустрии автоматического проветривания (и даже не предполагал о её существовании), а потому решил действовать по наитию.</p>
<p>Если формально, то техническое задание было придумано такое. Сделать магическую коробочку для поддержания оптимальной температуры в комнате во время отопительного сезона. На основании температуры в комнате должно выбираться наиболее оптимальное положение форточки, при котором температура не упадёт ниже комфортного уровня, но при этом сохранится наибольший приток свежего воздуха.</p>
<p>С чего же начать? Пожалуй, с механики. Самый простой способ что-то двигать с помощью электричества &mdash; это электромотор, вращающий свой вал. После недолгих поисков был куплен простейший редукторный шаговый моторчик, который ставят в очень бюджетные принтеры. Обвязка в виде термометра и ардуины нашлась в закромах.</p>
<p>Работа закипела: за два дня был собран первый прототип на макетной плате и написана первая версия прошивки. Но это и правда было увлекательно, а потому просто. Только вот как превратить крутящий момент мотора в поступательное движение? Себе-то я этот вопрос не задавал, ведь под парами всегда стоит 3D принтер. При помощи нескольких пластиковых деталей, болта с гайкой и капли суперклея мотор научился передвигать каретку в плоскости, перпендикулярной валу.</p>
<div> 
    <blockquote>
        <details>
        <summary><b>Тут много подробностей о костылях, которые пришлось применить</b></summary>
            <p>Ну что, вперёд-назад каретка ездит, прошивка худо-бедно мотор крутит. Запускаем? <b>Щаз!</b></p>
            <p><i>Проблема первая: тяга мотора примерно нулевая.</i> Ни одна библиотека не помогла. А ещё и драйвер я достал не удобный, которому только частоту шагов подавай, а дедовский, который всего лишь сигнал с логического на силовой уровень меняет. Пришлось руками прописывать все такты мотора, анализируя принцип работы по гифке из интернета. Зато после этого момент вращения стал очень даже приличным. Всю зиму алгоритм шага не менялся, заеданий <i>практически</i> не было.</p>
            <p><i>Проблема вторая: клинит!</i> Я радостно закрепил мотор на оконной раме, установил на створку ответную часть и осознал, что только в одном положении гайка нормально ходит по винту: при полностью закрытом окне. Времени заказывать гибкие муфты не было, поэтому был предпринят отчаянный шаг: мотор поселился на крючке-ограничителе. А что? К раме закреплён крепко, люфта как раз хватает чтобы окно могло приоткрываться. Смекало4ка!</p>
            <img src="media/v0.1_motor-down.jpg" alt="Крепление мотора" style="width:100%; max-width:500px;">
            <p><i>Проблема вторая с половиной: снова клинит!</i> Теперь люфт оказался уже излишним. В положении закрытого окна мотор сильно менял своё положение и после этого уже не мог открыть окно. Пришлось приобрести длинную пружину, которая тянула всю систему вверх и удерживала мотор в оптимальном положении. Некрасиво, но сработало.</p>
        </details>
    </blockquote>
</div>
<p>Дальше нужно было решить вопросы чисто эстетического плана: сделать корпус для электроники, собрать провода в жгут, отладить прошивку. Со временем прошивка научилась фиксировать окно в нескольких промежуточных положениях, красиво мигать светодиодом и даже автоматически вынимать винт из гайки, позволяя <i>кожаному мешку</i> самостоятельно открывать окно.</p>
<p>И вот результат работы: слева на фотографии самое начало проекта, а справа &mdash; состояние устройства через четыре месяца. И видео в качестве дополнения: <a href="media/v1.mp4">тык</a>.</p>
<table style="margin-top:-30px">
    <tr style="border:hidden;">
        <td>
            <img src='media/v0.1-down.jpg' alt='v0.1' />
        </td>
        <td>
            <img src='media/v1_1-down.jpg' alt='v1' />
        </td>
    </tr>
</table>
<p>Но чего-то всё равно не хватало. Не хватало компактности, эстетичности и стабильности работы.<br>
На дворе осень 2022 года и я работаю над второй версией устройства. Она хоть и дороже, но куда компактнее и умнее предыдущей. Термометр работает по WiFi, мотор управляется хорошим драйвером, в качестве вала используется специальный винт. <em>To be continued,</em> как говорится&hellip;</p>


  </div>

  <footer class="post-footer">
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://ichekanov.ru/">Заметочки</a></span>
    
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
